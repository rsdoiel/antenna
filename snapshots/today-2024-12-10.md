---
title: News gathered 2024-12-10
updated: 2024-12-10 07:09:07
---

# News gathered 2024-12-10

(date: 2024-12-10 07:09:07)

---

## Congress Pushes Apple to Remove Deepfake Apps After 404 Media Investigation

date: 2024-12-10, from: 404 Media Group

Congress is asking Apple, Google, Microsoft, and other big tech companies why they can’t get their deepfake problem under control. 

<br> 

<https://www.404media.co/congress-pushes-apple-to-remove-deepfake-apps-after-404-media-investigation/>

---

**@Dave Winer's linkblog** (date: 2024-12-10, from: Dave Winer's linkblog)

Yesterday I did a podcast about why it&#39;s important to choose humble names for groups of developers working on open formats. 

<br> 

<https://shownotes.scripting.com/scripting/2024/12/09/weAllOwnAndNoOneOwnsPodcasting.html>

---

**@Dave Winer's linkblog** (date: 2024-12-10, from: Dave Winer's linkblog)

The social web is much bigger than ActivityPub. 

<br> 

<https://socialwebfoundation.org/2024/11/01/fosdem-2025-social-web-devroom-call-for-participation/>

---

## Golden Artches

date: 2024-12-10, updated: 2024-12-10, from: One Foot Tsunami

 

<br> 

<https://onefoottsunami.com/2024/12/10/golden-artches/>

---

## Location Data Firm Offers to Help Cops Track Targets via Doctor Visits

date: 2024-12-10, from: 404 Media Group

Fog Data Science is a location tracking company that takes data harvested from smartphones and makes it accessible to cops. A document obtained by 404 Media shows the company explicitly says it will use doctors visits to unmask a target if needed. 

<br> 

<https://www.404media.co/location-data-firm-offers-to-help-cops-track-targets-via-doctor-visits/>

---

## This 3.4 inch mini PC has an Intel N150 processor, 2 LAN ports, and supports 3 displays

date: 2024-12-10, from: Liliputing

<p>The M8S Twin Lake mini PC features a 6-watt Intel N150 quad-core processor, 12GB of LPDDR5-4800 RAM, and an M.2 slot for solid state storage. It also features plenty of ports, including two Gigabit Ethernet ports, two HDMI ports, and a DisplayPort, allowing you to use the computer as a networking device, digital signage system, or multimedia PC, [&#8230;]</p>
<p>The post <a href="https://liliputing.com/this-3-4-inch-mini-pc-has-an-intel-n150-processor-2-lan-ports-and-supports-3-displays/">This 3.4 inch mini PC has an Intel N150 processor, 2 LAN ports, and supports 3 displays</a> appeared first on <a href="https://liliputing.com">Liliputing</a>.</p>
 

<br> 

<https://liliputing.com/this-3-4-inch-mini-pc-has-an-intel-n150-processor-2-lan-ports-and-supports-3-displays/>

---

**@Dave Winer's linkblog** (date: 2024-12-10, from: Dave Winer's linkblog)

The creator of ChatGPT&#39;s voice wants to build the tech from &#39;Her,&#39; minus the dystopia. 

<br> 

<https://techcrunch.com/2024/12/09/the-creator-of-chatgpts-voice-wants-to-build-the-tech-from-her-minus-the-dystopia/>

---

## Generative Logic

date: 2024-12-10, from: O'Reilly Radar

Alibaba’s latest model, QwQ-32B-Preview, has gained some impressive reviews for its reasoning abilities. Like OpenAI’s GPT-4 o1,1 its training has emphasized reasoning rather than just reproducing language. That seemed like something worth testing out—or at least playing around with—so when I heard that it very quickly became available in Ollama and wasn’t too large to [&#8230;] 

<br> 

<https://www.oreilly.com/radar/generative-logic/>

---

## Sora still appears to have trouble with physics

date: 2024-12-10, from: Gary Marcus blog

Exactly as I warned in February 

<br> 

<https://garymarcus.substack.com/p/sora-still-appears-to-have-trouble>

---

## propublica/weepeople: A typeface of people sillhouettes, to make it easy to build web graphics featuring little people instead of dots.

date: 2024-12-10, from: Dave Winer's linkblog

A typeface of people sillhouettes, to make it easy to build web graphics featuring little people instead of dots. 

<br> 

<https://github.com/propublica/weepeople?tab=readme-ov-file>

---

## UnitedHealthcare Shooting Person of Interest Had 3D Printed Glock

date: 2024-12-10, from: 404 Media Group

In what might be the first assassination in the United States using a 3D printed weapon, multiple people told 404 Media an image of the weapon found on the person of interest in the shooting of the UnitedHealthcare CEO looks like a specific design of 3D printed Glock. 

<br> 

<https://www.404media.co/unitedhealthcare-shooting-person-of-interest-had-3d-printed-glock/>

---

**@Dave Winer's linkblog** (date: 2024-12-09, from: Dave Winer's linkblog)

I did a podcast interview with with George Lakoff in 2008 in Berkeley, where I was living at the time. Pretty sure it was his first podcast. 

<br> 

<http://scripting.com/stories/2008/02/25/interviewWithGeorgeLakoff.html>

---

## Lilbits: New software can breathe new life into discontinued hardware

date: 2024-12-09, from: Liliputing

<p>Google announced two years ago that it was killing its short-lived Stadia game streaming service. and while the company was refunding customers who&#8217;d purchased games and hardware, folks who&#8217;d purchased the Stadia Controller weren&#8217;t thrilled that Google&#8217;s original plans would have led to the device becoming useless once the servers shut down. Fortunately Google later [&#8230;]</p>
<p>The post <a href="https://liliputing.com/lilbits-new-software-can-breath-new-life-into-discontinued-hardware/">Lilbits: New software can breathe new life into discontinued hardware</a> appeared first on <a href="https://liliputing.com">Liliputing</a>.</p>
 

<br> 

<https://liliputing.com/lilbits-new-software-can-breath-new-life-into-discontinued-hardware/>

---

**@IIIF Mastodon feed** (date: 2024-12-09, from: IIIF Mastodon feed)

<p>Unfortunately, the December <a href="https://glammr.us/tags/IIIF" class="mention hashtag" rel="tag">#<span>IIIF</span></a> Community Call has been cancelled. Please be on the lookout for a rescheduled date in early 2025.</p><p><a href="https://glammr.us/@IIIF/113595996406055008" target="_blank" rel="nofollow noopener noreferrer" translate="no"><span class="invisible">https://</span><span class="ellipsis">glammr.us/@IIIF/11359599640605</span><span class="invisible">5008</span></a></p> 

<br> 

<https://glammr.us/@IIIF/113624648832187901>

---

**@Dave Winer's linkblog** (date: 2024-12-09, from: Dave Winer's linkblog)

Person of Interest in UnitedHealthcare CEO’s Killing Identified as Prep School Valedictorian. 

<br> 

<https://www.yahoo.com/news/person-interest-unitedhealthcare-ceo-killing-181942543.html>

---

## Selling Outside of the Mac App Store

date: 2024-12-09, from: Michael Tsai

Matthias Gansrigler: But once the Mac App Store hit, I transitioned all my apps to it pretty much right away. It&#8217;s just so convenient: no license creation, no license verification (apart from receipt validation, but that has become more convenient recently), easy updating, no handling of payments, invoices, refunds, and the potential of getting featured [&#8230;] 

<br> 

<https://mjtsai.com/blog/2024/12/09/selling-outside-of-the-mac-app-store/>

---

## NetNewsWire 6.1.6

date: 2024-12-09, from: Michael Tsai

Brent Simmons (release notes): The theme of this release is using less bandwidth (and, as a consequence, less battery). It fixes a conditional GET issue and it now pays attention to Cache-Control response headers and 429 response codes. It also fixes an AppleScript bug I reported. Previously: ReadKit 3.3 News Explorer 2.0 NetNewsWire and Conditional [&#8230;] 

<br> 

<https://mjtsai.com/blog/2024/12/09/netnewswire-6-1-6/>

---

## FTC and CFPB Reining in Data Brokers

date: 2024-12-09, from: Michael Tsai

FTC (tweet): The Federal Trade Commission will prohibit data broker Mobilewalla, Inc. from selling sensitive location data, including data that reveals the identity of an individual&#8217;s private home, to settle allegations the data broker sold such information without taking reasonable steps to verify consumers&#8217; consent. Under the FTC&#8217;s proposed settlement order, Mobilewalla will also be [&#8230;] 

<br> 

<https://mjtsai.com/blog/2024/12/09/ftc-and-cfpb-reigning-in-data-brokers/>

---

## Tim Cook Interview About AI and AVP

date: 2024-12-09, from: Michael Tsai

Steven Levy (MacRumors): We are here to discuss Cook&#8217;s big move in this high-stakes environment: the impending release of Apple Intelligence, the company&#8217;s first significant offering in the white-hot field of generative AI. Some consider it belated. All year, Apple&#8217;s competitors have been gaining buzz, dazzling investors, and dominating the news cycle with their chatbots, [&#8230;] 

<br> 

<https://mjtsai.com/blog/2024/12/09/tim-cook-interview-about-ai-and-avp/>

---

## Cards! Cards! Cards

date: 2024-12-09, from: Computer ads from the Past

Do you want one? Maybe two? 

<br> 

<https://computeradsfromthepast.substack.com/p/cards-cards-cards>

---

## Daily Deals (12-09-2024)

date: 2024-12-09, from: Liliputing

<p>The Google Pixel Tablet, Amazon&#8217;s Fire Tablets, and several Samsung tablets are all on sale with prices matching their Black Friday and/or Cyber Monday pricing. Best Buy is running a sale on a bunch of laptops. And you can score a popular Bluetooth speaker for $40 off at the moment. Meanwhile Lenovo is running a [&#8230;]</p>
<p>The post <a href="https://liliputing.com/daily-deals-12-09-2024/">Daily Deals (12-09-2024)</a> appeared first on <a href="https://liliputing.com">Liliputing</a>.</p>
 

<br> 

<https://liliputing.com/daily-deals-12-09-2024/>

---

**@Dave Winer's linkblog** (date: 2024-12-09, from: Dave Winer's linkblog)

Why is America &quot;Trumpomuskovia&quot;? 

<br> 

<https://snyder.substack.com/p/why-trumpomuskovia?publication_id=310897&post_id=152794390&isFreemail=true&r=w33x&triedRedirect=true>

---

**@Dave Winer's linkblog** (date: 2024-12-09, from: Dave Winer's linkblog)

Bluesky is missing the one thing that would make it convincingly open, simplicity. They&#39;re blowing a lot of smoke at the idea of whether they&#39;re open or not. There could be a pony behind the smoke, or not. 

<br> 

<https://battellemedia.com/archives/2024/11/bluesky-twitter-and-the-open-network>

---

## MeLE QuieterDL is a fanless mini PC with Intel N100 and two 2.5 GbE LAN ports

date: 2024-12-09, from: Liliputing

<p>The MeLE QuieterDL is a small computer that&#8217;s just a little larger than two big smartphone stacked atop one another. But it&#8217;s a full-fledged computer with an Intel N100 quad-core processor, Windows 11 Home pre-installed, and support for up to 16GB of RAM and 512GB of storage. It&#8217;s similar in a lot of ways to the MeLE [&#8230;]</p>
<p>The post <a href="https://liliputing.com/mele-quieterdl-is-a-fanless-mini-pc-with-intel-n100-and-two-2-5-gbe-lan-ports/">MeLE QuieterDL is a fanless mini PC with Intel N100 and two 2.5 GbE LAN ports</a> appeared first on <a href="https://liliputing.com">Liliputing</a>.</p>
 

<br> 

<https://liliputing.com/mele-quieterdl-is-a-fanless-mini-pc-with-intel-n100-and-two-2-5-gbe-lan-ports/>

---

## 404 Media Objects to Texas Attorney General Ken Paxton's Subpoena to Access Our Reporting

date: 2024-12-09, from: 404 Media Group

404 Media's reporting on an internal Google privacy violation database has been subpoenaed by the State of Texas. We are fighting it.  

<br> 

<https://www.404media.co/404-media-objects-to-texas-attorney-general-ken-paxtons-subpoena-to-access-our-reporting/>

---

## Raspberry Pi 500 computer-in-a-keyboard is now available for $90

date: 2024-12-09, from: Liliputing

<p>The Raspberry Pi 500 is a compact desktop computer that combines a 2.4 GHz Broadcom BC2712 quad-core ARM Cortex-A76 processor, 8GB of LPDDR4x-4267 memory, and support for WiFi 5, Bluetooth 5.0, and Gigabit Ethernet. It&#8217;s also the second computer-in-a-keyboard device from Raspberry Pi. The first was the Raspberry Pi 400, which launched in 2020 with the [&#8230;]</p>
<p>The post <a href="https://liliputing.com/raspberry-pi-500-computer-in-a-keyboard-is-now-available-for-90/">Raspberry Pi 500 computer-in-a-keyboard is now available for $90</a> appeared first on <a href="https://liliputing.com">Liliputing</a>.</p>
 

<br> 

<https://liliputing.com/raspberry-pi-500-computer-in-a-keyboard-is-now-available-for-90/>

---

## Somewhere Along the Way, a Mistake Had Been Made

date: 2024-12-09, updated: 2024-12-09, from: One Foot Tsunami

 

<br> 

<https://onefoottsunami.com/2024/12/09/somewhere-along-the-way-a-mistake-had-been-made/>

---

**@Dave Winer's linkblog** (date: 2024-12-09, from: Dave Winer's linkblog)

These guidelines evolved over many years of trying to reason with trolls and spammers. 

<br> 

<https://this.how/commentGuidelines/>

---

## 15 Times to use AI, and 5 Not to

date: 2024-12-09, from: One Useful Thing

Notes on the Practical Wisdom of AI Use 

<br> 

<https://www.oneusefulthing.org/p/15-times-to-use-ai-and-5-not-to>

---

## Find Me on Bluesky

date: 2024-12-09, from: Aaron Bos blog

I have mixed feelings about social media and the value it provides, but I've recently joined Bluesky in hopes of regaining the value that I used to get out of Twitter/X from a developer's perspective. 

<br> 

<https://aaronbos.dev/posts/find-me-on-bluesky>

---

## Raspberry Pi 500 and Raspberry Pi Monitor on sale now

date: 2024-12-09, from: Raspberry Pi News (.com)

<p>Announcing the hotly anticipated Raspberry Pi 500, available now at $90, and Raspberry Pi Monitor, on sale at $100.</p>
<p>The post <a href="https://www.raspberrypi.com/news/raspberry-pi-500-and-raspberry-pi-monitor-on-sale-now/">Raspberry Pi 500 and Raspberry Pi Monitor on sale now</a> appeared first on <a href="https://www.raspberrypi.com">Raspberry Pi</a>.</p>
 

<br> 

<https://www.raspberrypi.com/news/raspberry-pi-500-and-raspberry-pi-monitor-on-sale-now/>

---

## Do General Audiences Exist?

date: 2024-12-09, from: Tedium site

Based on the sharp decline of the G rating, apparently not. Let’s look at the oddities of the broadest film rating. 

<br> 

<https://feed.tedium.co/link/15204/16914237/mpaa-g-rating-history>

---

## The Curious About Everything Newsletter #45

date: 2024-12-09, from: Curious about everything blog

The many interesting things I read in November 2024 

<br> 

<https://jodiettenberg.substack.com/p/forty-five>

---

## Episode 127 - Molecular Electronic Computer

date: 2024-12-09, from: Advent of Computing

<p data-pm-slice="0 0 []">In 1961 Texas Instruments unveiled the Molecular Electronic Computer, aka: Mol-E-Com. It was a machine that fit in the palm of your hand, but had all the power of a much larger computer. This was in an age of hefty machines, which made the achievement all the more marvelous. How was this even possible? It was all thanks to the wonders of molecular electronics, and a boat load of funding from the US Air Force.</p> <p>Selected Sources:</p> <p> <a href= "https://web.archive.org/web/20160304071831/http://corphist.computerhistory.org/corphist/documents/doc-496d289787271.pdf" rel="noopener noreferrer nofollow" data-link-auto= "">https://web.archive.org/web/20160304071831/http://corphist.computerhistory.org/corphist/documents/doc-496d289787271.pdf</a> - Invention of the Integrated Circuit, Kilby</p> <p><a href= "https://archive.org/details/DTIC_AD0411614/page/n15/mode/2up" rel= "noopener noreferrer nofollow" data-link-auto= "">https://archive.org/details/DTIC_AD0411614/page/n15/mode/2up</a> - Investigation of Silicon Functional Blocks, TI</p> <p><a href="https://apps.dtic.mil/sti/tr/pdf/AD0273850.pdf" rel= "noopener noreferrer nofollow">https://apps.dtic.mil/sti/tr/pdf/AD0273850.pdf</a> - Silicon Semiconductor Networks, TI</p> 

<audio crossorigin="anonymous" controls="controls">
<source type="audio/mpeg" src="https://traffic.libsyn.com/secure/adventofcomputing/ep127_mol_e_com.mp3?dest-id=1206722"></source>
</audio> <a href="https://traffic.libsyn.com/secure/adventofcomputing/ep127_mol_e_com.mp3?dest-id=1206722" target="_blank">download audio/mpeg</a><br> 

<https://adventofcomputing.libsyn.com/episode-127-molecular-electronic-computer>

---

**@Dave Winer's linkblog** (date: 2024-12-09, from: Dave Winer's linkblog)

Severance Season 2 Official Trailer. 

<br> 

<https://m.youtube.com/watch?v=_UXKlYvLGJY&t=68s&pp=2AFEkAIB>

---

## Quickstart - Automate &amp; Scale Tunnels with Inlets Uplink

date: 2024-12-09, updated: 2024-12-09, from: Inlets.dev, cloud tunneling

Inlets Uplink is a complete solution for automating tunnels, that scales from anywhere from ten to tens of thousands of tunnels. 

<br> 

<https://inlets.dev/blog/tutorial/2024/12/09/quickstart-uplink.html>

---

## How Can I Be An AI Engineer?

date: 2024-12-09, updated: 2024-12-09, from: Tom Kellog blog

You want to be an AI Engineer? Do you even have the right skills? What do they do? All great questions. 
I’ve had this 
same conversation several times, so I figured it would be best to write it down. Here I answer all those,
and break down the job into archetypes that should help you understand how you’ll contribute. 

<br> 

<http://timkellogg.me/blog/2024/12/09/ai-engineer>

---

## Lightstorm: minimalistic Ruby compiler

date: 2024-12-09, from: LLVM Blog

<p>Some time ago I was talking about an <a href="https://www.youtube.com/watch?v=NfMX-dFMSr0">ahead-of-time Ruby compiler</a>.We started the project with certain goals and hypotheses in mind, and while the original compiler is at nearly 90% completion, there are still those other 90% that needs to be done.</p><p>In the meantime, we decided to strip it down to a bare minimum and implement just enough features to validate the hypotheses.</p><p>Just like the original compiler we use MLIR to bridge the gap between Ruby VM&rsquo;s bytecode and the codegen, but instead of targeting LLVM IR directly, we go through EmitC dialect and targeting C language, as it significantly simplifies OS/CPU support. We go into a bit more details later.</p><p>The source code of our minimalistic Ruby compiler is here: <a href="https://github.com/dragonruby/lightstorm">https://github.com/dragonruby/lightstorm</a>.</p><p>The rest of the article covers why we decided to build it, how we approached the problem, and what we discovered along the way.</p><h2 id="motivation-and-the-use-case">Motivation and the use case</h2><p>Our use case is pretty straightforward: we are building <a href="https://dragonruby.org">a cross-platform game engine that&rsquo;s indie-focused, productive, and easy to use</a>. The game engine itself is written in a mix of C and Ruby, but the main user-interface is the Ruby itself.</p><p>As soon as the game development is done and the game is ready for &ldquo;deployment,&rdquo; the code is more or less static and so we asked ourselves if we can pre-compile it into machine code to make it run faster.</p><p>But given all the dynamism of Ruby, why would a compilation make it faster?</p><p>So here comes our hypothesis. But first let&rsquo;s look at some high-level implementation details to see where the hypothesis comes from.</p><h2 id="compilers-vs-interpreters">Compilers vs Interpreters</h2><p>While a language itself cannot be strictly qualified as compiled or interpreted, the typical implementations certainly are.</p><p>In case of a &ldquo;compiled&rdquo; language the compiler would take the whole program, analyze it and produce the machine code targeting a specific hardware (real or virtual), while an interpreter would take the program and execute it right away, one &ldquo;instruction&rdquo; at a time.</p><p><em>The definition above is a bit handwavy: zoom our far enough and everything is a compiler, zoom in close enough and everything is an interpreter. But you&rsquo;ve got the gist.</em></p><p>Most Ruby implementations are interpreter-based, and in our case we are using <a href="https://mruby.org">mruby</a>.</p><p>The mruby interpreter is a lightweight register-based virtual machine (VM).</p><p>Let&rsquo;s look at a concrete example. The following piece of code:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ruby" data-lang="ruby"><span style="display:flex;"><span><span style="color:#ae81ff">42</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">15</span></span></span></code></pre></div><p>is converted into the following VM bytecode, consisting of various operations (ops for short):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-asm" data-lang="asm"><span style="display:flex;"><span><span style="color:#a6e22e">LOADI</span> <span style="color:#66d9ef">R1</span> <span style="color:#ae81ff">42</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">LOADI</span> <span style="color:#66d9ef">R2</span> <span style="color:#ae81ff">15</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">ADD</span> <span style="color:#66d9ef">R1</span> <span style="color:#66d9ef">R2</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">HALT</span></span></span></code></pre></div><p>The VM&rsquo;s interpreter loop looks as follows (pseudocode):</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span>dispatch_next:</span></span><span style="display:flex;"><span> Op op <span style="color:#f92672">=</span> bytecode.<span style="color:#a6e22e">next_op</span>();</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">switch</span> (op.opcode) {</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">case</span> LOADI: {</span></span><span style="display:flex;"><span> vstack.<span style="color:#a6e22e">store</span>(op.dest, <span style="color:#a6e22e">mrb_int</span>(op.literal));</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> dispatch_next;</span></span><span style="display:flex;"><span> }</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">case</span> ADD: {</span></span><span style="display:flex;"><span> mrb_value lhs <span style="color:#f92672">=</span> vstack.<span style="color:#a6e22e">load</span>(op.lhs);</span></span><span style="display:flex;"><span> mrb_value rhs <span style="color:#f92672">=</span> vstack.<span style="color:#a6e22e">load</span>(op.rhs);</span></span><span style="display:flex;"><span> vstack.<span style="color:#a6e22e">store</span>(op.dest, <span style="color:#a6e22e">mrb_add</span>(lhs, rhs));</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> dispatch_next;</span></span><span style="display:flex;"><span> }</span></span><span style="display:flex;"><span> <span style="color:#75715e">// More ops...</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> <span style="color:#66d9ef">case</span> HALT: <span style="color:#66d9ef">goto</span> halt_vm;</span></span><span style="display:flex;"><span> }</span></span><span style="display:flex;"><span></span></span><span style="display:flex;"><span>halt_vm:</span></span><span style="display:flex;"><span> <span style="color:#75715e">// ...</span></span></span></code></pre></div><p>For each bytecode operation the VM will jump/branch into the right opcode handler, and then will branch back to the beginning of the dispatch loop.In the meantime, each opcode handler would use a virtual stack (confusingly located on the heap) to store intermediate results.</p><p>If we unroll the above bytecode manually, then the code can look like this:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> loadi_1;</span></span><span style="display:flex;"><span></span></span><span style="display:flex;"><span>loadi_1:</span></span><span style="display:flex;"><span> <span style="color:#75715e">// LOADI R1 42</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> mrb_value t1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mrb_int</span>(<span style="color:#ae81ff">42</span>);</span></span><span style="display:flex;"><span> vstack.<span style="color:#a6e22e">store</span>(<span style="color:#ae81ff">1</span>, t1);</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> loadi_2;</span></span><span style="display:flex;"><span></span></span><span style="display:flex;"><span>loadi_2:</span></span><span style="display:flex;"><span> <span style="color:#75715e">// LOADI R2 42</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> mrb_value t2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mrb_int</span>(<span style="color:#ae81ff">15</span>);</span></span><span style="display:flex;"><span> vstack.<span style="color:#a6e22e">store</span>(<span style="color:#ae81ff">2</span>, t2);</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> add;</span></span><span style="display:flex;"><span></span></span><span style="display:flex;"><span>add:</span></span><span style="display:flex;"><span> <span style="color:#75715e">// ADD R1 R2</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span> mrb_value lhs <span style="color:#f92672">=</span> vstack.<span style="color:#a6e22e">load</span>(<span style="color:#ae81ff">1</span>);</span></span><span style="display:flex;"><span> mrb_value rhs <span style="color:#f92672">=</span> vstack.<span style="color:#a6e22e">load</span>(<span style="color:#ae81ff">2</span>);</span></span><span style="display:flex;"><span> mrb_value t3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mrb_add</span>(lhs, rhs);</span></span><span style="display:flex;"><span> vstack.<span style="color:#a6e22e">store</span>(<span style="color:#ae81ff">1</span>, t3);</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> halt;</span></span><span style="display:flex;"><span></span></span><span style="display:flex;"><span>halt:</span></span><span style="display:flex;"><span> <span style="color:#75715e">// shutdown VM</span></span></span></code></pre></div><p>Many items in this example can be eliminated: specifically, we can avoid load/stores from/to the heap, and we can safely eliminate <code>goto</code>s/branches:</p><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span> mrb_value t1 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mrb_int</span>(<span style="color:#ae81ff">42</span>);</span></span><span style="display:flex;"><span> mrb_value t2 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mrb_int</span>(<span style="color:#ae81ff">15</span>);;</span></span><span style="display:flex;"><span> mrb_value t3 <span style="color:#f92672">=</span> <span style="color:#a6e22e">mrb_add</span>(t1, t2);</span></span><span style="display:flex;"><span> vstack.<span style="color:#a6e22e">store</span>(<span style="color:#ae81ff">1</span>, t3);</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">goto</span> halt;</span></span><span style="display:flex;"><span></span></span><span style="display:flex;"><span>halt:</span></span><span style="display:flex;"><span> <span style="color:#75715e">// shutdown VM</span></span></span></code></pre></div><p>So here goes our hypothesis:</p><blockquote><h3 id="hypothesis">Hypothesis</h3><p>By precompiling/unrolling the VM dispatch loop we can eliminate many load/stores and branches along with branch mispredictions, this should improve the performance of the end program.</p></blockquote><p>We can also try to apply some optimizations based on the high-level bytecode analysis, but due to the Ruby&rsquo;s dynamism the static optimization surface is limited.</p><h2 id="approach">Approach</h2><p>As mentioned in the beginning, building a full-fledged AOT compiler is a laborious task which requires time and has certain constraints.</p><p>For the minimalistic version we decided to change/relax some of the constraints as follows:</p><ul><li>the compiled code must be compatible with the existing ecosystem/runtime</li><li>the existing runtime must not require any changes</li><li>the supported language features should be easily &ldquo;representable&rdquo; in C</li></ul><p>Unlike the original compiler, we are not targeting machine code directly, but C instead.This eliminates a lot of complexity, but it also means that we only support a subset of the language (e.g., blocks and exceptions are missing at the moment).</p><p>This is obviously not ideal, but it serves important purpose - <strong>our goal at this point is to validate the hypothesis</strong>.</p><p>A classical compilation pipeline looks as follows:</p><p><img src="https://blog.llvm.org/img/ruby-compiler/compilation-pipeline.png" alt="Classical compilation pipeline"></p><p>To build a compiler one needs to implement the conversions from the raw source file all the way down to machine code and the language runtime library.Since we are targeting the existing implementation, we have the benefit of reusing the frontend (parsing + AST) and the runtime library.</p><p>Still, we need to implement the conversion from AST to the machine code.And this is where the power of MLIR kicks in: we built a custom dialect (<a href="https://github.com/DragonRuby/lightstorm/blob/3ed0077af589ba51b98954bba8869daf58e22b9e/include/lightstorm/dialect/rite.td">Rite</a>) which represents mruby VM&rsquo;s bytecode, and then use a number of builtin dialects (<code>cf</code>, <code>func</code>, <code>arith</code>, <code>emitc</code>) to convert our IR into C code.</p><p>At this point, we can just use clang to compile/link the code together with the existing runtime and that&rsquo;s it.</p><p>The final compilation pipeline looks as follows:</p><p><img src="https://blog.llvm.org/img/ruby-compiler/lightstorm-compilation-pipeline.png" alt="Lightstorm compilation pipeline"></p><blockquote><p>With the benefit of MLIR we are able to build a funtional compiler in just a couple of thousands lines of code!</p></blockquote><p>Now let&rsquo;s look at how it performs.</p><h2 id="some-numbers">Some numbers</h2><p>Benchmarking is hard, so take these numbers with a grain of salt.</p><p>We run various (micro)-benchmarks showing results in the range of 1% to 1200% speedups, but we are sticking to the <a href="https://openbenchmarking.org/test/pts/aobench">aobench</a> as it is very close to the game-dev workloads we are targeting.</p><p>mruby also uses <a href="https://github.com/mruby/mruby/blob/e05dbf7bbc6d2fbecfd7d4a46418fbe4421bc160/benchmark/bm_ao_render.rb">aobench</a> as part of its benchmark suite, though we slightly modified it to replace <code>Number.each</code> blocks with explicit <code>while</code> loops.</p><p>Next we used excellent <a href="https://github.com/lunacookies/simple-kpc">simple-kpc</a> library to capture CPU counters on Apple M1 CPU, namely we collect total cycles, total instructions count, branches, branch mispredictions, and load/stores (<code>FIXED_CYCLES</code>, <code>FIXED_INSTRUCTIONS</code>, <code>INST_BRANCH</code>, <code>BRANCH_MISPRED_NONSPEC</code>, and <code>INST_LDST</code> respectively).</p><p>Naturally, we also collect the total execution time.</p><p>All the benchmarks compare vanilla bytecode interpretation against the &ldquo;unrolled&rdquo; compiled version.</p><p>We are using mruby 3.0. While it&rsquo;s not the most recent version at the time of writing, it was the most recent version at the time we&rsquo;ve build the compiler.</p><p>The following chart shows the results of our measurements.The three versions we compare are the baseline on the left, compiled version without optimizations in the middle, and the compiled version plus <a href="https://github.com/DragonRuby/lightstorm/blob/09042d2026f9251ff32ec079d99bf8ca2e5a6337/lib/optimizations/optimizations.cpp#L14">simple escape analysis</a> and common subexpression elimination (CSE) on the right side.</p><p><em>The raw data and the formulas are <a href="https://docs.google.com/spreadsheets/d/1KQdZjll0cOjWhfPO3KM-FN-OciUW53IecGOtTY6aYJM/edit?usp=sharing">here</a>.</em></p><p><img src="https://blog.llvm.org/img/ruby-compiler/benchmark.png" alt="Benchmarks"></p><p>With all the current optimizations in place both the number of cycles and the total execution time went down by roughly ~30%.</p><p>We are able to eliminate ~17% of branches and ~28% of load/stores, while the branch misses were cut in half with ~55% decrease.</p><p>The numbers look promising, although the amount of load/stores and branches will certainly go up as we implement all the language features due to the way blocks and exceptions are handled.</p><p>On the other hand, we didn&rsquo;t touch the runtime implementation which together with LTO will enable some more improvements due to more inlining.</p><h2 id="where-to-next">Where to next?</h2><p>As mentioned in the beginning, some parts of the engine itself are written in C with and some of them are purely due to performance reasons. We are looking into replacing those critical pieces with compiled Ruby. While we may still pay performance penalty, we hope that ease of maintenance will be worthwile.</p><p>In the meantime, do not hesitate to give it a shot, and if you have any questions reach out to <a href="https://lowlevelbits.org/about/">Alex</a> or <a href="https://amirrajan.net">Amir</a>!</p><h2 id="some-links">Some links</h2><ul><li>the compiler: <a href="https://github.com/DragonRuby/lightstorm">https://github.com/DragonRuby/lightstorm</a></li><li>the game engine: <a href="https://dragonruby.org">https://dragonruby.org</a></li><li>our discord: <a href="https://discord.dragonruby.org">https://discord.dragonruby.org</a></li></ul> 

<br> 

<https://blog.llvm.org/posts/2024-12-03-minimalistic-ruby-compiler/>

