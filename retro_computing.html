<!doctype html>
<html lang="en-US">
<head>
  <meta charset="utf-8" >
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" >
  <title>retro computing</title>
<!--  <link rel="stylesheet" type="text/css"  href="webfonts/fonts.css" media="screen" > -->
  <link rel="stylesheet" type="text/css"  href="css/site.css" media="screen" >
</head>
<body>
<header>
	<img class="logo" 
		src="https://upload.wikimedia.org/wikipedia/commons/9/9c/Antenna_1_-_The_Noun_Project.svg"
		alt="line art showing an antenna"
		height="80" width="60" >
	<h1>The Antenna</h1> 
	<h2>finding signal in the noise</h2>
</header>
<nav>
<ul>
	<li><a href="./">The Antenna</a></li>
	<li><a href="archives/">Archives</a></li>
	<li><a href="about.html">About</a></li>
</ul>
</nav>
<section>
<div class="description-for-items">
Items collected from feeds in <a href="retro_computing.txt">retro_computing.txt</a>
</div>
<h1 id="retro-computing">retro computing</h1>
<p>(date: 2025-06-02 06:07:42)</p>
<hr />
<h2 id="wrocc-june-2025-talk-on-wednesday---rool">WROCC June 2025 talk
on wednesday - ROOL</h2>
<p>date: 2025-06-02, from: Icon Bar, RISC OS News</p>
<p>The June 2025 WROCC talk is on wednesday and starts at at 7.45pm on
Zoom</p>
<p><br></p>
<p><a href="http://www.iconbar.com/comments/rss/news2204.html"
class="uri">http://www.iconbar.com/comments/rss/news2204.html</a></p>
<hr />
<h2 id="dosview-1.7">DosView 1.7</h2>
<p>date: 2025-06-01, from: FreeDOS News</p>
<div class="markdown_content">
<p>
DosView is an image viewer/converter for DOS that supports a ton of
common image formats including BMP, PCX, GIF, JPB, PNG, WEBP, GIF, and
others. Version 1.7 provides updates and fixes, including: fixing a
crash when running out of memory, adding a key to display help, and
patching and updating libraries. You can find the source code at
<a class="" href="https://github.com/SuperIlu/DosView" rel="nofollow">DosView
on GitHub</a>. Download the new version from the
<a class="" href="https://github.com/SuperIlu/DosView/releases/tag/v1.7" rel="nofollow">v1.7
release</a> on GitHub.
</p>
</div>
<p><br></p>
<p><a href="https://sourceforge.net/p/freedos/news/2025/06/dosview-17/"
class="uri">https://sourceforge.net/p/freedos/news/2025/06/dosview-17/</a></p>
<hr />
<h2
id="b.log-20250601---that-was-unexpected-how-big-so-close-yet-so-far.">b.log
2025/06/01 - That was unexpected, HOW BIG?, So close yet so far.</h2>
<p>date: 2025-06-01, from: Richard Murray’s blog</p>
<p>That was unexpected, HOW BIG?, So close yet so far.</p>
<p><br></p>
<p><a href="https://heyrick.eu/blog/index.php?diary=20250601"
class="uri">https://heyrick.eu/blog/index.php?diary=20250601</a></p>
<hr />
<h2 id="plus-post-sony-smc-777c">Plus Post: Sony SMC-777C</h2>
<p>date: 2025-06-01, from: Computer ads from the Past</p>
<p>One person, Eight languages. The 8bit.</p>
<p><br></p>
<p><a
href="https://computeradsfromthepast.substack.com/p/plus-post-sony-smc-777c"
class="uri">https://computeradsfromthepast.substack.com/p/plus-post-sony-smc-777c</a></p>
<hr />
<h2
id="harpoom-of-course-the-apple-network-server-can-be-hacked-into-running-doom">Harpoom:
of course the Apple Network Server can be hacked into running Doom</h2>
<p>date: 2025-06-01, from: Old Ventage Computing Research</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnqfUawyNyYKRGO-01Lk92zV2YGSHzF9NU7_OW2N9sJ6GNjdv601KAOFWTfkEMlNt2Axixub3ZMIIq6RgDP_c-doA5dRLS6LTTKDd1kjvwFSzbB4vcSvbgExXz8DzzascSfa-yqCAxNccr-g_q46voehRUPtQ7TMV9uU3glYMeJMU7JtkA-3Mn9mlcJKc/s4080/PXL_20250527_223741214.LONG_EXPOSURE-01.COVER.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" height="320" data-original-height="4080" data-original-width="3072" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgnqfUawyNyYKRGO-01Lk92zV2YGSHzF9NU7_OW2N9sJ6GNjdv601KAOFWTfkEMlNt2Axixub3ZMIIq6RgDP_c-doA5dRLS6LTTKDd1kjvwFSzbB4vcSvbgExXz8DzzascSfa-yqCAxNccr-g_q46voehRUPtQ7TMV9uU3glYMeJMU7JtkA-3Mn9mlcJKc/s320/PXL_20250527_223741214.LONG_EXPOSURE-01.COVER.jpg"/></a>
</div>
Of course you can run Doom on
<a href="/2023/11/the-apple-network-servers-all-too.html">a $10,000+
Apple server</a> running IBM AIX. Of <em>course</em> you can. Well, you
can <em>now</em>.
<p>
Now, let’s go ahead and get the grumbling out of the way. No, the ANS is
not running Linux or NetBSD. No, this is not a backport of
<a href="https://www.youtube.com/watch?v=XzhCGSE7KKw">NCommander’s AIX
Doom</a>, because that runs on
<a href="https://github.com/NCommander/aix_doom_things">AIX 4.3</a>. The
Apple Network Server could run no version of AIX later than 4.1.5 and
there are substantial technical differences. (As it happens, the very
fact it won’t run on an ANS was what prompted me to embark on this port
in the first place.) And no, this is not merely an exercise in flogging
a geriatric compiler into building
<a href="https://github.com/ozkl/doomgeneric">Doom Generic</a>, though
we’ll necessarily do that as part of the conversion. There’s no AIX
sound driver for ANS audio, so this port is mute, but at the end we’ll
have a Doom executable that runs well on the ANS console under CDE and
has no other system prerequisites. We’ll even test it on one of IBM’s
PowerPC AIX laptops as well. Because we <em>should</em>.
<p>
<p><a name='more'></a></p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEgAw169Pu52UVihwsjme6kkJRl9npM4EP9lPIsUF3hElG_QXborX6t_4QFXkeDReIex0PbyFmksgPn44ew6GGTn7zZTDK_vsG111xDr7H1rB-JbSF-S_dAKr7qsx6zXCDNdhyBJL66d2bYo56X_1QwzxH9KWkcgEy-gP_WDHh2erkndkpF5gyIHtGLMM/s1698/rtpc-1986-clip.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="1594" data-original-width="1698" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiEgAw169Pu52UVihwsjme6kkJRl9npM4EP9lPIsUF3hElG_QXborX6t_4QFXkeDReIex0PbyFmksgPn44ew6GGTn7zZTDK_vsG111xDr7H1rB-JbSF-S_dAKr7qsx6zXCDNdhyBJL66d2bYo56X_1QwzxH9KWkcgEy-gP_WDHh2erkndkpF5gyIHtGLMM/s320/rtpc-1986-clip.jpg"/></a>
</div>
AIX (“Advanced Interactive Executive”) ended up as the 1996 Apple
Network Server’s primary operating system
<a href="/2023/11/the-apple-network-servers-all-too.html">almost by
default</a>, Apple’s first true Unix server since the A/UX-based
Workgroup Server 95, but IBM AIX has a long history of its own dating
back to the 1986 IBM RT PC. That machine was based on the IBM ROMP CPU
as derived from the IBM 801, generally considered the first modern RISC
design. AIX started as an early port of UNIX System V Release 3 and is
thus a true Unix descendent, but also merged in some code from BSD 4.2
and 4.3. The RT PC ran AIX v1 and v2 as its primary operating systems,
though IBM also supported 4.3BSD (ported by IBM as the Academic
Operating System) and a spin of Pick OS. Although a truly full-fledged
workstation with aggressive support from IBM, it ended up a failure in
the market due to comparatively poor performance and notorious problems
with its floating point support.
<p>
<p>Nevertheless, AIX’s workstation roots persisted even through the
substantial rewrite that became version 3 in 1989, and was likewise the
primary operating system for its next-generation technical workstations
now based on POWER. AIX 3 introduced AIXwindows, a licensed port of
X.desktop from IXI Limited (later acquired by another licensee, SCO)
initially based on X11R3 with Motif as the
toolkit.<!-- http://ps-2.kev009.com/wisclibrary/techlib/manuals/adoclib/aixins/inslppkg/aixwinco.htm#yECAi17alapw -->
In 1993 the “SUUSHI” partnership — named for its principals, Sun, Unix
System Laboratories, the Univel joint initiative of Novell and AT&amp;T,
SCO, HP and IBM — negotiated an armistice in the Unix Wars, their
previous hostilities now being seen as counterproductive against common
enemy Microsoft. This partnership led to the Common Open Software
Environment (COSE) initiative and the Common Desktop Environment (CDE),
derived from
<a href="/2023/01/saic-galaxy-1100-pre-cde-vue-of-pa-risc.html">HP
VUE</a>, which was also Motif-based.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWNU78iHCDSNolJdwG4XjPAezncwalz4-PsMf49Dnhu_XznOvLlxJyyy1Opdtc-4JlzsPtXj4zf5ymqaJe-0pjaP8agvCieomy5TO6q8-NAKu0ltuZwUyYmQcpwq_T-pWJiXI1g4ADj0Np9qaWwsjiSD-UbghwOD70y9L5pKzcQgvJFCm9_725U1Avl0w/s1334/rsulti-clip.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" height="320" data-original-height="1334" data-original-width="1012" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhWNU78iHCDSNolJdwG4XjPAezncwalz4-PsMf49Dnhu_XznOvLlxJyyy1Opdtc-4JlzsPtXj4zf5ymqaJe-0pjaP8agvCieomy5TO6q8-NAKu0ltuZwUyYmQcpwq_T-pWJiXI1g4ADj0Np9qaWwsjiSD-UbghwOD70y9L5pKzcQgvJFCm9_725U1Avl0w/s320/rsulti-clip.png"/></a>
</div>
Coincidentially (probably), the first AIX release to feature CDE is
4.1.4, the first official release of AIX (as 4.1.4.1) to run on the ANS.
(4.1.2 was only used on pre-release ANSes and never supported nor sold
by Apple.) Having professionally worked with RS/6000 and Power ISA
hardware since 3.2.5, AIX 4 is in my not-so-humble-opinion the operating
system’s zenith as a workstation OS. Indeed, this was the PowerOpen era,
with common ABI support with Mac OS, and there was even some period of
time in which
<a href="/2023/11/the-apple-network-servers-all-too.html">AIX might have
<em>been</em> the next Mac OS</a>. For that matter, OS/2 was still a
thing on the desktop (as Warp 4) despite Workplace OS’s failure,
Ultimedia was a major IBM initiative in desktop multimedia, and the
Common User Access model was part of CDE too. AIX 4 had multimedia
capabilities as well through its own native port of Ultimedia,
supporting applications like video capture and desktop video
conferencing, and even featured
<a href="gopher://gopher.floodgap.com/1/archive/aix-games">several game
ports IBM themselves developed</a> — two for AIX 4.1 (Quake and Abuse)
and one later for 4.3 (Quake II). The 4.1 game ports run well on ANS AIX
with the Ultimedia libraries installed, though oddly Doom was never one
of them. IBM cancelled all this with AIX 5L and never looked back.
<p>
<p>ANS “Harpoon” AIX only made two standard releases, 4.1.4.1 and 4.1.5,
prior to Gil Amelio
<a href="/2023/11/the-apple-network-servers-all-too.html">cancelling the
line in April 1997</a>. However, ANS AIX is almost entirely
binary-compatible with regular 4.1 and there is pretty much no reason
<em>not</em> to run 4.1.5, so we’ll make that our baseline. Although AIX
4.3 was a big jump forward, for our purposes the major difference is
support for X11R6 as 4.1 only supports X11R5. Upgrading the X11
libraries is certainly possible but leads to a non-standard
configuration, and anyway, the official
<a href="https://github.com/id-Software/DOOM">id Linux port</a> by Dave
Taylor hails from 1994 when many X11R5 systems would have still been out
there. We would also rather avoid forcing people to install Ultimedia.
There shouldn’t be anything about basic Doom that would require anything
more than the basic operating system we have.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEju9KmnvA_XWogEd4pIujPywsHdaQNMrdnwpArTgVuxdtiN4C7vuwVLnPLa3N3A_A8vftjYLqeHuz6q7kE10j3q4G8iwpzIkqeB2CKholD2IyqlSbtbbPP375cKw_NXiLLvJT9j5FfhP2R4Bn6iSkqnDC-F6e9Z8LOdAFaeS_xoy-1mKJ974Gg6cRjnWss/s3360/Screenshot%202025-05-28%20at%203.34.55%E2%80%AFPM.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="2100" data-original-width="3360" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEju9KmnvA_XWogEd4pIujPywsHdaQNMrdnwpArTgVuxdtiN4C7vuwVLnPLa3N3A_A8vftjYLqeHuz6q7kE10j3q4G8iwpzIkqeB2CKholD2IyqlSbtbbPP375cKw_NXiLLvJT9j5FfhP2R4Bn6iSkqnDC-F6e9Z8LOdAFaeS_xoy-1mKJ974Gg6cRjnWss/s320/Screenshot%202025-05-28%20at%203.34.55%E2%80%AFPM.png"/></a>
</div>
The <a href="https://www.youtube.com/watch?v=XzhCGSE7KKw">NCommander AIX
Doom</a> port is based on
<a href="https://doomwiki.org/wiki/Chocolate_Doom">Chocolate Doom</a>,
taking advantage of SDL 1.2’s partial support for AIX. Oddly, the
headers for the MIT Shared Memory Extension were reportedly missing on
4.3 despite the X server being fully capable of it, and he ended up
cribbing them from a modern copy of Xorg to get it to build. Otherwise,
much of his time was spent bringing in other necessary SDL libraries and
getting the sound working, neither of which we’re going to even attempt.
Owing to the ANS’ history as a heavily modified Power Macintosh 9500, it
thus uses
<a href="/2022/12/the-strange-case-of-beos-srs-and-silent.html">AWACS
audio</a> for which no driver was ever written for AIX, and AIX 4.1 only
supports built-in audio on IBM hardware. Until that changes or someone™
figures out an alternative, the most audio playback you’ll get from
Harpoon AIX is the server quacking on beeps (yes, I said quacking, the
same as the Mac alert sound).
<p>
However, <a href="https://github.com/ozkl/doomgeneric">Doom Generic</a>
is a better foundation for exotic Doom ports because it assumes very
little about the hardware and has straight-up Xlib support, meaning we
won’t need SDL or even MIT-SHM. It also removes architecture-specific
code and is endian-neutral, important because AIX to this day remains
big-endian, though this is less of a issue with Doom specifically since
it was originally written on
<a href="https://www.johnromero.com/news/2016/2/14/apple-next-merger-birthday">big-endian
NeXTSTEP 68K and PA-RISC</a>.
<p>
We now need to install a toolchain, since Harpoon AIX does not include
an <tt>xlC</tt> license, and I’d be interested to hear from anyone
trying to build this with it. Although the venerable AIXPDSLIB archive
formerly at UCLA has gone to the great bitbucket in the sky, there are
some archives of it around and I’ve reposted the packages I personally
kept for 4.1 and 3.2.5 on
<a href="gopher://gopher.floodgap.com/1/archive/ans-aixpdslib-aix-4">the
Floodgap gopher server</a>. The most recent compiler AIXPDSLIB had for
4.1 was <tt>gcc</tt> 2.95.2, though for fun I installed the slightly
older <tt>egcs</tt> 2.91.66, and you will also need GNU <tt>make</tt>,
for which 3.81 is the latest available. These compilers use the on-board
assembler and linker. I did not attempt to build a later compiler with
this compiler. It may work and you get to try that yourself. Optionally
you can also install <tt>gdb</tt> 5.3, which I did to stomp out some
glitches. These packages are all <tt>uncompress</tt>ed and
un-<tt>tar</tt>red from the root directory in place; they don’t need to
be installed through <tt>smit</tt>. I recommend symlinking
<tt>/usr/local/bin/make</tt> as <tt>/usr/local/bin/gmake</tt> so we know
which one we’re using.
<p>
Finally, we’ll need a catchy name for our port. Originally it was going
to be ANS Doom, but that sounded too much like Anus Doom, which I
proffer as a free metal band name and I look forward to going to one of
their concerts soon. Eventually I settled on Harpoom, which I felt was
an appropriate nod to its history while weird enough to be notable.
<a href="https://github.com/classilla/harpoom">All of my code is on
Github</a> along with pre-built binaries and all development was done on
<tt>stockholm</tt>, my original Apple Network Server 500 that I’ve owned
continuously
<a href="/2023/11/the-apple-network-servers-all-too.html">since
1998</a>, with a 200MHz PowerPC 604e, 1MB of cache, 512MB of parity RAM
and a single disk here running a clean install of 4.1.5.
<p>
Starting with Doom Generic out of the box, we’ll begin with a
<tt>Makefile</tt> to create a basic Doom that I can run over remote X
for convenience. (Since the ANS runs big-endian, if you run a recent
little-endian desktop as I do with my POWER9 you’ll need to start your
local X server with <tt>+byteswappedclients</tt> or
<a href="https://www.talospace.com/2023/01/your-x-server-may-no-longer-swing-both.html">a
configuration file change</a>, or the connection will fail.) I copied
<tt>Makefile.freebsd</tt> and stripped it down to
<p>
<div class="tx">
<pre>
CC=gcc
CFLAGS+=-g -O2 -I/usr/local/include
LDFLAGS+=-L/usr/local/lib
CFLAGS+=-DNORMALUNIX
LIBS+=-lm -lc -lX11
</pre>
</div>
<p>
I also removed <tt>-Wl,-Map,$(OUTPUT).map</tt> from the link step in
advance because AIX <tt>ld</tt> will barf on that. <tt>gmake</tt>
understood the <tt>Makefile</tt> fine but the compile immediately
bombed. It’s time to get out that clue-by-four and start bashing the
compiler with it.
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% gmake
[Compiling dummy.c]
In file included from dummy.c:13:
doomtype.h:63: inttypes.h: No such file or directory
gmake: *** [build/dummy.o] Error 1
</pre>
</div>
<p>
There is, in fact, no <tt>inttypes.h</tt> or <tt>stdint.h</tt> on AIX
4.1.
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% find /usr/include -name 'stdint.h' -print
stockholm:/home/spectre/src/doomgeneric/% find /usr/include -name 'inttypes.h' -print
stockholm:/home/spectre/src/doomgeneric/% find /usr/local/include -name 'stdint.h' -print
stockholm:/home/spectre/src/doomgeneric/% find /usr/local/include -name 'inttypes.h' -print
</pre>
</div>
<p>
So let’s create an <tt>stdint.h</tt>! We could copy it from somewhere
else, but I wanted this to only specify what it needed to. After several
false starts, the final draft was
<p>
<div class="tx">
<pre>
#ifndef __INTTYPES
#define __INTTYPES 1
typedef signed char int8_t;
typedef unsigned char uint8_t;
typedef signed short int16_t;
typedef unsigned short uint16_t;
typedef signed int int32_t;
typedef signed int intptr_t;
typedef unsigned int uint32_t;
typedef unsigned int uintptr_t;
typedef signed long long int64_t;
typedef unsigned long long uint64_t;
#endif
</pre>
</div>
<p>
and we include that instead of <tt>inttypes.h</tt>. Please note this is
only valid for 32 bit systems like this one.
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% gmake
[...]
[Compiling i_sound.c]
[Compiling i_system.c]
[Compiling i_timer.c]
In file included from i_timer.c:22:
doomgeneric.h:5: stdint.h: No such file or directory
gmake: *** [build/i_timer.o] Error 1
</pre>
</div>
<p>
Obviously we’ll change that from <tt>&lt;stdint.h&gt;</tt> to
<tt>“stdint.h”</tt>.
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% gmake
[...]
[Compiling i_video.c]
In file included from i_video.c:41:
/usr/local/lib/gcc-lib/rs6000-ibm-aix4.1.5.0/egcs-2.91.66/include/stdbool.h:9: conflicting types for `false'
doomtype.h:88: previous declaration of `false'
/usr/local/lib/gcc-lib/rs6000-ibm-aix4.1.5.0/egcs-2.91.66/include/stdbool.h:11: conflicting types for `true'
doomtype.h:89: previous declaration of `true'
i_video.c:128: conflicting types for `col_t'
/usr/include/sys/localedef31.h:48: previous declaration of `col_t'
i_video.c: In function `I_InitGraphics':
i_video.c:239: parse error before `extern'
gmake: *** [build/i_video.o] Error 1
</pre>
</div>
<p>
<tt>doomtype.h</tt> has this definition for a <tt>boolean</tt>:
<p>
<div class="tx">
<pre>
typedef enum
{
    false       = 0,
    true        = 1,
        undef   = 0xFFFFFFFF
} boolean;
</pre>
</div>
<P>
Despite this definition, <tt>undef</tt> isn’t actually used in the
codebase anywhere, and if C++ <tt>bool</tt> is available then it just
<tt>typedef</tt>s it to <tt>boolean</tt>. But <tt>egcs</tt> and
<tt>gcc</tt> come with their own definition, here in its entirety:
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% more /usr/local/lib/gcc-lib/rs6000-ibm-aix4.1.5.0/egcs-2.91.66/include/stdbool.h
/* stdbool.h for GNU.  */
#ifndef __STDBOOL_H__
#define __STDBOOL_H__   1

/* The type `bool' must promote to `int' or `unsigned int'.  The constants
   `true' and `false' must have the value 0 and 1 respectively.  */
typedef enum
  {
    false = 0,
    true = 1
  } bool;

/* The names `true' and `false' must also be made available as macros.  */
#define false   false
#define true    true

/* Signal that all the definitions are present.  */
#define __bool_true_false_are_defined   1

#endif  /* stdbool.h */
</pre>
</div>
<P>
This is almost identical. Since we know we don’t really need
<tt>undef</tt>, we comment out the old definition in
<tt>doomtype.h</tt>, <tt>#include &lt;stdbool.h&gt;</tt> and just
<tt>typedef bool boolean</tt> like C++.
<p>
The <tt>col_t</tt> is an AIX specific problem that conflicts with AIX
locales. Since <tt>col_t</tt> is only found in <tt>i_video.c</tt>, we’ll
just change it in four places to <tt>doomcol_t</tt>.
<p>
The last problem was this bit of code at the end of
<tt>I_InitGraphics()</tt>:
<p>
<div class="tx">
<pre>
    extern void I_InitInput(void);
    I_InitInput();
}
</pre>
</div>
<p>
Here we can cheat, being pre-C99, by merely removing the declaration.
This is aided by the fact <tt>I_InitInput</tt> neither passes nor
returns anything. The compiler accepted that.
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% gmake
[Compiling i_video.c]
[Compiling doomgeneric.c]
[Compiling doomgeneric_xlib.c]
doomgeneric_xlib.c:14: X11/XKBlib.h: No such file or directory
gmake: *** [build/doomgeneric_xlib.o] Error 1
</pre>
</div>
<p>
X11R5 does not support the X Keyboard Extension (<tt>Xkb</tt>). To make
the compile go a bit farther I switched out <tt>X11/XKBlib.h</tt> for
<tt>X11/keysym.h</tt>. We’re going to have some missing symbols at link
time but we’ll deal with that momentarily.
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% gmake
[Compiling doomgeneric_xlib.c]
doomgeneric_xlib.c: In function `DG_Init':
doomgeneric_xlib.c:90: parse error before `int'
doomgeneric_xlib.c:94: `attr' undeclared (first use in this function)
doomgeneric_xlib.c:94: (Each undeclared identifier is reported only once
doomgeneric_xlib.c:94: for each function it appears in.)
doomgeneric_xlib.c:98: parse error before `int'
doomgeneric_xlib.c:100: `blackColor' undeclared (first use in this function)
doomgeneric_xlib.c:108: `whiteColor' undeclared (first use in this function)
doomgeneric_xlib.c:124: `depth' undeclared (first use in this function)
gmake: *** [build/doomgeneric_xlib.o] Error 1
</pre>
</div>
<p>
<tt>DG_Init()</tt> is naughty and didn’t declare all its variables at
the beginning. This version of the compiler can’t cope with that and I
had to rework the function. Although my revisions compiled, the link
failed, as expected:
<p>
<div class="tx">
<pre>
stockholm:/home/spectre/src/doomgeneric/% gmake
[Compiling doomgeneric_xlib.c]
[Linking doomgeneric]
ld: 0711-317 ERROR: Undefined symbol: .XkbSetDetectableAutoRepeat
ld: 0711-317 ERROR: Undefined symbol: .XkbKeycodeToKeysym
ld: 0711-345 Use the -bloadmap or -bnoquiet option to obtain more information.
collect2: ld returned 8 exit status
gmake: *** [doomgeneric] Error 1
stockholm:/home/spectre/src/doomgeneric/% grep Xkb *
doomgeneric_xlib.c:    XkbSetDetectableAutoRepeat(s_Display, 1, 0);
doomgeneric_xlib.c:                KeySym sym = XkbKeycodeToKeysym(s_Display, e.xkey.keycode, 0, 0);
doomgeneric_xlib.c:                KeySym sym = XkbKeycodeToKeysym(s_Display, e.xkey.keycode, 0, 0);
</pre>
</div>
<p>
<tt><a href="https://www.x.org/releases/X11R7.6/doc/man/man3/XkbSetDetectableAutoRepeat.3.xhtml">XkbSetDetectableAutoRepeat</a></tt>
tells the keyboard driver to not generate synthetic <tt>KeyRelease</tt>
events for this X client when a key is auto-repeating. X11R5 doesn’t
have this capability, so the best we can do is
<tt><a href="https://tronche.com/gui/x/xlib/input/XAutoRepeatOff.html">XAutoRepeatOff</a></tt>,
which still gives us single <tt>KeyPress</tt> and <tt>KeyRelease</tt>
events but that’s because it disables key repeat <em>globally</em>. (A
footnote on this later on.) There’s not a lot we can do about that,
though we can at least add an <tt>atexit</tt> to ensure the previous
keyboard repeat status is restored on quit.
<p>
Similarly, there is no exact equivalent for
<tt><a href="https://www.x.org/archive/X11R7.5/doc/man/man3/XkbKeycodeToKeysym.3.html">XkbKeycodeToKeysym</a></tt>,
though we can sufficiently approximate it for our purposes with
<tt><a href="https://tronche.com/gui/x/xlib/utilities/keyboard/XLookupKeysym.html">XLookupKeysym</a></tt>
in both places:
<p>
<div class="tx">
<pre>
/*
                KeySym sym = XkbKeycodeToKeysym(s_Display, e.xkey.keycode, 0, 0);
*/
                KeySym sym = XLookupKeysym(&amp;e.xkey, 0);
</pre>
</div>
<p>
That was enough to link Doom Generic. Nevertheless, with our
<tt>$DISPLAY</tt> properly set and using the
<a href="https://www.doomworld.com/classicdoom/info/shareware.php">shareware
WAD</a>, it immediately fails:
<p>
<div class="tx">
<pre>
                           Doom Generic 0.1
Z_Init: Init zone memory allocation daemon. 
zone memory: 20158008, 600000 allocated for zone
Using . for configuration and saves
V_Init: allocate screens.
M_LoadDefaults: Load system defaults.
saving config in .default.cfg
-iwad not specified, trying a few iwad names
Trying IWAD file:doom2.wad
Trying IWAD file:plutonia.wad
Trying IWAD file:tnt.wad
Trying IWAD file:doom.wad
W_Init: Init WADfiles.
 adding doom.wad
Couldn't realloc lumpinfo
</pre>
</div>
<p>
This error comes from this block of code in <tt>w_wad.c</tt>:
<p>
<div class="tx">
<pre>
// Increase the size of the lumpinfo[] array to the specified size.
static void ExtendLumpInfo(int newnumlumps)
{
    lumpinfo_t *newlumpinfo;
    unsigned int i;

    newlumpinfo = calloc(newnumlumps, sizeof(lumpinfo_t));

    if (newlumpinfo == NULL)
    {
        I_Error ("Couldn't realloc lumpinfo");
    }
</pre>
</div>
<p>
With some debugging <tt>printf</tt>s, we discover the value of
additional lumps we’re being asked to allocate is totally bogus:
<p>
<div class="tx">
<pre>
W_Init: Init WADfiles.
 adding doom.wad
ExtendLumpInfo: -268173312
</pre>
</div>
<p>
This nonsense number is almost certainly caused by an unconverted
little-endian value. Values in WADs are stored little-endian, even in
the native Macintosh port. Doom Generic does have primitives for
handling byteswaps, however, so it seems to have incorrectly detected us
as little-endian. After some <tt>grep</tt>ping this detection quite
logically comes from <tt>i_swap.h</tt>. As we have intentionally not
enabled sound, for some reason (probably an oversight) this file ends up
defaulting to little endian:
<p>
<div class="tx">
<pre>
#else  // FEATURE_SOUND

#define SHORT(x)  ((signed short) (x))
#define LONG(x)   ((signed int) (x))

#define SYS_LITTLE_ENDIAN

#endif /* FEATURE_SOUND */
</pre>
</div>
<p>
Ordinarily this would be a great place to use <tt>gcc</tt>’s byteswap
intrinsics, buuuuuuuuut (and I was pretty sure this would happen) …
<p>
<div class="tx">
<pre>
ld: 0711-317 ERROR: Undefined symbol: .__builtin_bswap32
ld: 0711-317 ERROR: Undefined symbol: .__builtin_bswap16
</pre>
</div>
<p>
so we’re going to have to write some. Since they’ve been defined as
quasi-functions, I decided to do this as actual inlineable functions
with a sprinkling of inline PowerPC assembly. The semantics of
<tt>static inline</tt> here are intended to take advantage of
<a href="https://www.greenend.org.uk/rjk/tech/inline.html">the way
<tt>gcc</tt> of this era handled it</a>.
<p>
<div class="tx">
<pre>
#else  // FEATURE_SOUND

static inline signed int LONG(signed int x) {
        signed int result;
        __asm__(
                "rotlwi %0, %1, 8\n"
                "rlwimi %0, %1, 24, 0, 7\n"
                "rlwimi %0, %1, 24, 16, 23\n"
                /* note: 64 bit would need an extsw here */

                /* out */ : "=&amp;r" (result)
                /* in  */ : "r"  (x));   
        return result; 
}

static inline signed short SHORT(signed short x) {
        signed short result;   
        __asm__(
                "rlwinm %0, %1, 24, 24, 31\n"
                "rlwinm 0, %1, 8, 16, 23\n"
                "or %0, %0, 0\n" 
                "extsh %0, %0\n"

                /* out */ : "=&amp;r" (result)
                /* in  */ : "r" (x)
                /* temp */: "0");
        return result;
}

#define SYS_BIG_ENDIAN

#endif /* FEATURE_SOUND */
</pre>
</div>
<p>
<p>These snippets are very nearly the optimal code sequences, at least
if the value is already in a register. If the value was being fetched
from memory, you can do the conversion in one step with single
instructions (<tt>lwbrx</tt> or <tt>lhbrx</tt>), but the way the code is
structured we won’t know where the value is coming from, so this is the
best we can do for now. Atypically, these conversions must be
<em>signed</em>. If you miss this detail and only handle the unsigned
case, as yours truly did in a first draft, you get weird things like
this:</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgStYYTu-gDj3hvNU9DA-k8cltgDxoIJ-aTYKx4-FRlfhfCnTKryBW3EtN11Sd4SiHRJEYMz-0LKEH0F26ltLB-rmxyp0HcnOGzKIBg3DmreBd3X5O8LP3R5-cnkDOG35myguJJzgYIWwqZIhyguQGStLrEiWMOF_o0GwJwc28kQ8z9U745RJ3B7Pf5LYg/s726/Screenshot_20250527_082419.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" height="320" data-original-height="726" data-original-width="590" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgStYYTu-gDj3hvNU9DA-k8cltgDxoIJ-aTYKx4-FRlfhfCnTKryBW3EtN11Sd4SiHRJEYMz-0LKEH0F26ltLB-rmxyp0HcnOGzKIBg3DmreBd3X5O8LP3R5-cnkDOG35myguJJzgYIWwqZIhyguQGStLrEiWMOF_o0GwJwc28kQ8z9U745RJ3B7Pf5LYg/s320/Screenshot_20250527_082419.png"/></a>
</div>
<p>Because the sign was not being extended on shorts we converted, but
<em>was</em> extended on values we did not, 16-bit values started
picking up wacky negative quantities because the most significant byte
eventually became all ones and 32-bit PowerPC GPRs are 32 bits, all the
time. Properly extending the sign after conversion was enough to fix
it.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjewQh-UtBs7W6AGV_xzaaYCcJ53aR1HM0zvDaaC6x86y-TNt2eHza5q8cH1YhJrZgL5PNNXFwwL2glWiMkJ2AU2SC12lGPlorzwgEXQ3X-BU5G4evPld4BBZ9HVCmL1p49xyivYc6viCgEyAMtruwgpzYU6zmzAWDDqwf0OnF3MJPffQJvTrXyqdUIaKE/s792/Screenshot_20250527_084628.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="550" data-original-width="792" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjewQh-UtBs7W6AGV_xzaaYCcJ53aR1HM0zvDaaC6x86y-TNt2eHza5q8cH1YhJrZgL5PNNXFwwL2glWiMkJ2AU2SC12lGPlorzwgEXQ3X-BU5G4evPld4BBZ9HVCmL1p49xyivYc6viCgEyAMtruwgpzYU6zmzAWDDqwf0OnF3MJPffQJvTrXyqdUIaKE/s320/Screenshot_20250527_084628.png"/></a>
</div>
<p>Now on our remote X debugging session, the game comes up and is
playable, and not overly slow via the network. (Insert anti-Wayland
snark here.)</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2mGB0cAfJSFjpfwFHmM1DLBU1I5Fd-Q3JKqqWG5l-fxF4mKsjOnskpta0jmwBExuH1FsLG1mOO0466txBhQviLCqXONszIftrtjQdsYqYj9mmtj58fTKLZKU6KFaVaR5qo3hyphenhyphen7hmYRJmcj4M-fw8DDDrWbTmeOcVYb3SjiN8kTk7pTrahmeRjCcryQWs/s4080/PXL_20250527_155044809.LONG_EXPOSURE%231.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="3072" data-original-width="4080" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2mGB0cAfJSFjpfwFHmM1DLBU1I5Fd-Q3JKqqWG5l-fxF4mKsjOnskpta0jmwBExuH1FsLG1mOO0466txBhQviLCqXONszIftrtjQdsYqYj9mmtj58fTKLZKU6KFaVaR5qo3hyphenhyphen7hmYRJmcj4M-fw8DDDrWbTmeOcVYb3SjiN8kTk7pTrahmeRjCcryQWs/s320/PXL_20250527_155044809.LONG_EXPOSURE%231.jpg"/></a>
</div>
On the console, however (pardon the colours in some of these pictures
because this CRT monitor’s red gun is iffy), the keys generally worked
but the screen was a mess. You can see several things here, notably that
the palette is completely wrong, there is an oversized ghost of the Doom
logo that appeared when we pressed ESC, and the “pixels” in general are
unreasonably swollen. The ANS’ video, not used in any other Apple
computer, is based on a 1MB Cirrus Logic 54M30. This setup maxes out at
1024x768 and has no provision for anything beyond an 8-bit colour depth.
Ignoring the palette for a moment, the X server and the game seem to
disagree on the number of bits per pixel: the game apparently thinks 32,
but the screen only allows 8.
<p>
<p>Going back to the code, there is provision in Doom Generic for an
8-bit colourmap with the compiler define <tt>CMAP256</tt>. Since this is
a compile-time choice, and we want to support both remote X and console
X, we’ll just make two builds. I rebuilt the executable this time adding
<tt>-DCMAP256</tt> to the <tt>CFLAGS</tt> in the <tt>Makefile</tt>.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVjdZNUgnlUfHmqB4dzNmfzuQY5MVmynUqviOL4TiwsGjWk3pptsezFmDOQr5hyphenhyphenpsRA4ARHUJG9x-C2E-IkXUmm7ZOVCYBsrR9Acr8HP8o7vT2uoVcyWjHx7szYCqXMHJT9M0Yq2MFw9Ia6a05aRtByv0lTW92gKdDxFxZdblT6INZklVumx2VAOkbJhQ/s4080/PXL_20250527_194304542.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="3072" data-original-width="4080" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjVjdZNUgnlUfHmqB4dzNmfzuQY5MVmynUqviOL4TiwsGjWk3pptsezFmDOQr5hyphenhyphenpsRA4ARHUJG9x-C2E-IkXUmm7ZOVCYBsrR9Acr8HP8o7vT2uoVcyWjHx7szYCqXMHJT9M0Yq2MFw9Ia6a05aRtByv0lTW92gKdDxFxZdblT6INZklVumx2VAOkbJhQ/s320/PXL_20250527_194304542.jpg"/></a>
</div>
We now have proper pixels, but the colour (modulo the iffy red gun) is
still very, very wrong. X can absolutely support <tt>PseudoColor</tt>
8-bit visuals, so we must not be creating a colourmap for the window nor
updating it, and indeed there is none in the Doom Generic source code.
Fortunately, there <em>is</em> in the original O.G. Linux Doom, so I
cribbed some code from it. I added a new function
<tt>DG_Upload_Palette</tt> to accept a 256-colour internal palette from
the device-independent portion, turn it into an X Colormap, and push it
to the X server with
<tt><a href="https://tronche.com/gui/x/xlib/color/XStoreColors.html">XStoreColors</a></tt>.
Because the engine changes the entire palette every time (on damage,
artifacts, etc.), we must set every colour change flag in the Colormap,
which we do and cache on first run just like O.G. Linux Doom did.
<p>
<div class="tx">
<pre>
#ifdef CMAP256

static XColor colors[256];
static int called = 0;
struct color { /* from i_video.h */
    uint32_t b:8;
    uint32_t g:8;
    uint32_t r:8;
    uint32_t a:8;
};

void DG_Upload_Palette(struct color *dgcolors) /* Cribbed from OG Linux DOOM */
{
        int c, i;

        if (!called)
        {
                called++;
                for(i=0; i&lt;256; i++)
                {
                        colors[i].pixel = i;
                        colors[i].flags = DoRed|DoGreen|DoBlue;
                }
        }

        /* Set X colormap entries */
        for (i=0; i&lt;256; i++) {
                colors[i].red = (dgcolors[i].r &lt;&lt; 8) | dgcolors[i].r;
                colors[i].blue = (dgcolors[i].b &lt;&lt; 8) | dgcolors[i].b;
                colors[i].green = (dgcolors[i].g &lt;&lt; 8) | dgcolors[i].g;
        }

        XStoreColors(s_Display, s_Cmap, colors, 256);
}
#endif
</pre>
</div>
<p>
<p>The last step is to tag the Colormap we create to the X window using
<tt><a href="https://tronche.com/gui/x/xlib/window/XSetWindowColormap.html">XSetWindowColormap</a></tt>.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjb5vFSlIJZSfKzve2_qwUnW12HEPNs_tt-PprATbBFOBeYofLmHzVjFP6r_N40_ky4aJi1H-2jqImDrazGdE_fZYzVeRwjQ-CYIy9JkIFPkoHTD8Wn_YmKzdJByS80elBTfOIbEtl56wZiFW_aSOx8vKPiYmKSq3Wq1eFw9uuRdA3GGg-BnKNsW9Ci2L0/s4080/PXL_20250527_222629616.LONG_EXPOSURE-01.COVER.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" height="320" data-original-height="4080" data-original-width="3072" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjb5vFSlIJZSfKzve2_qwUnW12HEPNs_tt-PprATbBFOBeYofLmHzVjFP6r_N40_ky4aJi1H-2jqImDrazGdE_fZYzVeRwjQ-CYIy9JkIFPkoHTD8Wn_YmKzdJByS80elBTfOIbEtl56wZiFW_aSOx8vKPiYmKSq3Wq1eFw9uuRdA3GGg-BnKNsW9Ci2L0/s320/PXL_20250527_222629616.LONG_EXPOSURE-01.COVER.jpg"/></a>
</div>
Now we have a proper display. The background windows look odd, but their
Colormap will be asserted instead when they are the active window.
That’s just what you have to live with under 256 colours. The same thing
happens with <a href="http://www.floodgap.com/retrobits/ans/shots/">the
other AIX games</a>, by the way.
<p>
<p>Here are some direct grabs from the framebuffer using <tt>xwd -icmap
-screen -root -out</tt>.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-ts3eYOz8_NnVkhuYXqfZ6eq0VgCrRY-maCTInYO3j4hVG6UqO3A0Iz3GSglw9VxonjQzMn_tPm-fNNL_XeopcgR7bXTnSP22DzkY1BTd6eQ5sHamk8LLvhJ9XoNpDy7idifBkJvNm-7-nCsBE2aTL4syx0Hv9c1CefEbKlnNUk75IxvFC_RSCcRmC7Q/s1024/doom.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi-ts3eYOz8_NnVkhuYXqfZ6eq0VgCrRY-maCTInYO3j4hVG6UqO3A0Iz3GSglw9VxonjQzMn_tPm-fNNL_XeopcgR7bXTnSP22DzkY1BTd6eQ5sHamk8LLvhJ9XoNpDy7idifBkJvNm-7-nCsBE2aTL4syx0Hv9c1CefEbKlnNUk75IxvFC_RSCcRmC7Q/s320/doom.png"/></a>
</div>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhSJUt7R2Hpt8oRjDIxiwMp2nq08LTuaUJhT1YJ3ybqjT8Glmm3WJUlXunKi4jkyi78QyWqlGtEjZ1buMO3dMN2qpBRCOOIkvO6TwLF84EKMsEWUFQE55KYZkYz4PjnUEbZK7ku1C3uLtxTcqBCMAZoLFuhb0Ig65D9ScyDD3lHd5HdyoHhXvup_www98/s1024/readthis.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="768" data-original-width="1024" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhhSJUt7R2Hpt8oRjDIxiwMp2nq08LTuaUJhT1YJ3ybqjT8Glmm3WJUlXunKi4jkyi78QyWqlGtEjZ1buMO3dMN2qpBRCOOIkvO6TwLF84EKMsEWUFQE55KYZkYz4PjnUEbZK7ku1C3uLtxTcqBCMAZoLFuhb0Ig65D9ScyDD3lHd5HdyoHhXvup_www98/s320/readthis.png"/></a>
</div>
In general moving around in the game worked fine (remote X sometimes
lagged a bit but the console worked well) except for strafing. Doom
Generic’s Xlib source doesn’t check for Alt keys. This makes sense
because it’s often something window managers trap, and indeed on CDE
Alt-Up or Alt-Down will hop to another window if you don’t release Alt
soon enough.
<p>
But we have an alternative on the ANS ADB keyboard: the Command keys.
The Command keys on Harpoon CDE appear to do nothing and that’s because
they <em>map</em> to nothing, not Meta, Super or even Hyper in Harpoon’s
X server. Instead, when pressed or released each Command key generates
an <tt>XEvent</tt> with an unexpected literal keycode of zero. After
some experimentation, it turns out that no other key (tested with a full
Apple Extended Keyboard II) on a connected ADB keyboard will generate
this keycode. I believe this was most likely an inadvertent bug on
Apple’s part but I decided to take advantage of it. I don’t think it’s a
good idea to do this if you’re running a remote X session and the check
is disabled there, but if you run the 256-colour version on the console,
you can use the Command keys to strafe instead (Alt works in either
version).
<p>
Lastly, I added some code to check the default or available visuals so
that you can’t (easily) run the wrong version in the wrong place and
bumped the optimization level to <tt>-O3</tt>. And that’s the game.
Here’s a video of it on the console, though I swapped in an LCD display
so that the CRT flicker won’t set you off. This is literally me pointing
my Pixel 7 Pro camera at the screen.
<p>
<div class="separator" style="clear: both; text-align: center;">
<iframe allowfullscreen="allowfullscreen" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" width="320" height="266" src="https://www.blogger.com/video.g?token=AD6v5dzprrjqCN21OeUVKbFz4ZKTIRGYxZW1CnqyEl8wEDSRWTszDyoP-vKI8csdPQwqmB1-YV_uYwMS3E7wlgQ0tQ" class="b-hbp-video b-uploaded" frameborder="0">
</iframe>
</div>
<p>
<p>However, this port should run just fine on anything else running AIX
4.1, not just the ANS. Sooooo … let’s get out something else running AIX
4.1!</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFmxM6WtjVai1-HcIZbhwGdxj9LShYvNzGYWh3cSe-wL7E0lojfAZsn-433UoySTPrdY820ygSpAlf4wbIGjfWEQy1BKizdYQ7c2sJLXVitVMuWhsbSoDZHxMiMrtFLK5jyvyAb_03D7YKiOf4nEMpfZeVkQ-CYLfHZACmkuXXc-J_I_kfljUD3FOlPrM/s4080/PXL_20250530_042220691.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" height="320" data-original-height="4080" data-original-width="3072" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFmxM6WtjVai1-HcIZbhwGdxj9LShYvNzGYWh3cSe-wL7E0lojfAZsn-433UoySTPrdY820ygSpAlf4wbIGjfWEQy1BKizdYQ7c2sJLXVitVMuWhsbSoDZHxMiMrtFLK5jyvyAb_03D7YKiOf4nEMpfZeVkQ-CYLfHZACmkuXXc-J_I_kfljUD3FOlPrM/s320/PXL_20250530_042220691.jpg"/></a>
</div>
<p>Here’s an IBM RS/6000 Notebook 860, another
<a href="2022/09/the-mips-thinkpad-kind-of.html">RISC ThinkPad-like
laptop</a> that isn’t, technically, a ThinkPad. You might see this
machine <a href="/search/label/ibm">in a future entry</a>.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg_a8zaoBI6aD3j0aHRgUYg8QPCLabrfQXwyjrKTZj-HQznnbiOywNYkKC9b5cz4K3mO2zFdr3u2LTTaXrpGnmQfYvB70GoQNB7I68vscQz_UXErSUQJuD_4l-De0Aw8fGyjWFEWPw849RKcEQi9DxYRipyuP1_MIj_A9l5bTntpIe8HbdEBSZB-dMFsG0/s4080/PXL_20250530_043652673.jpg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" height="320" data-original-height="4080" data-original-width="3072" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg_a8zaoBI6aD3j0aHRgUYg8QPCLabrfQXwyjrKTZj-HQznnbiOywNYkKC9b5cz4K3mO2zFdr3u2LTTaXrpGnmQfYvB70GoQNB7I68vscQz_UXErSUQJuD_4l-De0Aw8fGyjWFEWPw849RKcEQi9DxYRipyuP1_MIj_A9l5bTntpIe8HbdEBSZB-dMFsG0/s320/PXL_20250530_043652673.jpg"/></a>
</div>
This machine is a good test because it also runs 4.1.5 (but IBM vanilla
AIX this time) and its GT20-based LCD display supports exactly the same
8-bit colour visual at 1024x768, yet it’s a 166MHz PowerPC 603e, slower
and with weaker integer performance than the 200MHz 604e we were
previously using, plus it only has half the L1 cache and just 256K of
L2.
<p>
<div class="separator" style="clear: both; text-align: center;">
<iframe allowfullscreen="allowfullscreen" webkitallowfullscreen="webkitallowfullscreen" mozallowfullscreen="mozallowfullscreen" width="320" height="266" src="https://www.blogger.com/video.g?token=AD6v5dxeN9G5Mp5dIW8N0682l24VQHAug02eT37i3B-dvqr9yUemZMOGXG5x17z55mG52pX_00q8kO8665zBU8XN6g" class="b-hbp-video b-uploaded" frameborder="0">
</iframe>
</div>
<p>
Despite that, though, the game runs credibly. (Sorry about the bad
angles but the 860’s LCD isn’t as good as the one I had attached to the
ANS.) The only thing that I did notice was that disabling key repeat
didn’t work for the left and right keys — if you hold them down, they
turn, stop, and then turn slower — while other keys seem normal. There
is no option to change this on a per-key basis in CDE (remember, no Xkb)
and near as I can determine the ANS and the 860 are configured the same.
There may be a difference in the X server which I’ll have to figure out
later. Our target system remains the Network Server but it’s nice to see
it running other places.
<p>
<p>In any event, have at it. Now your ANS has something new to do. The
source code and
<a href="https://github.com/classilla/harpoom/releases/tag/initial">precompiled
builds both for 24-bit and 8-bit colour</a> are
<a href="https://github.com/classilla/harpoom">available on Github</a>.
Like Doom Generic and the original Doom, Harpoom is released under the
GNU General Public License v2.</p>
<div class="separator" style="clear: both;">
<a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEggxlKOdfHNPncyDpJB-NKXej-FEqhOQJ9Ag_oXkAnsT87dtYq6sz7SvrRQLC5hniH7sq4PUMhf3Gd0FQXgkzQ5FAcR5TpcGzu2g7wFicavG3vYbQmV3Kqf5nFD7T_cE8mXissmtOdEQ6FaAymrFj4E1uuKkOJM7dj3VEYq24YMw2-zaVrd_q8stf5L2uw/s792/Screenshot_20250527_150517.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" width="320" data-original-height="550" data-original-width="792" src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEggxlKOdfHNPncyDpJB-NKXej-FEqhOQJ9Ag_oXkAnsT87dtYq6sz7SvrRQLC5hniH7sq4PUMhf3Gd0FQXgkzQ5FAcR5TpcGzu2g7wFicavG3vYbQmV3Kqf5nFD7T_cE8mXissmtOdEQ6FaAymrFj4E1uuKkOJM7dj3VEYq24YMw2-zaVrd_q8stf5L2uw/s320/Screenshot_20250527_150517.png"/></a>
</div>
<p><br></p>
<p><a
href="https://oldvcr.blogspot.com/2025/05/harpoom-of-course-apple-network-server.html"
class="uri">https://oldvcr.blogspot.com/2025/05/harpoom-of-course-apple-network-server.html</a></p>
</section>
<footer>
Antenna is a personal aggregation of items found around the web.
Curated with <a href="https://rsdoiel.github.io/skimmer">skimmer</a> and <a href="https://sqlite.org">sqlite</a> then rendered with <a href="https://pandoc.org">Pandoc</a>.
</footer>
</body>
</html>
